package au.csiro.aehrc.clinicaltrialssearch;


import junit.framework.TestCase;

public class StripCompletionDateTest extends TestCase {


	
	public void test_stripCompletionDate() {

        String longJSON = "{\"clinical_study\":{\"brief_summary\":{\"textblock\":\"High protein diets are popular among Maori, especially on the East Coast of the North\r\n      Island. The purpose of this study was to compare the metabolic effects of a moderate\r\n      carbohydrate, high protein diet (MCHP) with a high carbohydrate-high fibre (HCHF) diet on\r\n      insulin sensitivity in Maori at increased risk of developing diabetes and cardiovascular\r\n      disease.\"},\"brief_title\":\"He Purongo Mo Nga Kai Hei Arai i Te Matehuka \u2013 Dietary Diabetes Prevention Study for Maori\",\"overall_status\":\"Completed\",\"link\":{\"description\":\"Edgar National Centre for Diabetes Research, NZ website\",\"url\":\"http://www.otago.ac.nz/diabetes\"},\"eligibility\":{\"minimum_age\":\"17.0\",\"gender\":\"Both\",\"criteria\":{\"textblock\":\"Inclusion Criteria:\r\n\r\n          -  Self identify as Maori aged between 17-75 years\r\n\r\n          -  Male and female\r\n\r\n          -  Non-diabetic\r\n\r\n          -  Resident of Dunedin and Invercargill\r\n\r\n          -  BMI >27\r\n\r\n          -  Family history of T2D\r\n\r\n        Exclusion Criteria:\r\n\r\n          -  The presence of diabetes, renal or liver failure, or any other medical condition\r\n             which is unstable and for which potential partcipants are currently having active\r\n             treatment.\"},\"healthy_volunteers\":\"Accepts Healthy Volunteers\",\"maximum_age\":\"75.0\"},\"source\":\"Edgar National Centre for Diabetes Research\",\"location_countries\":{\"country\":\"New Zealand\"},\"sponsors\":{\"lead_sponsor\":{\"agency_class\":\"Other\",\"agency\":\"Edgar National Centre for Diabetes Research\"}},\"overall_official\":[{\"role\":\"Principal Investigator\",\"affiliation\":\"Edgar National Centre for Diabetes Research, Dunedin, NZ\",\"last_name\":\"Lorraine Brooking, BSc, MA\"},{\"role\":\"Study Director\",\"affiliation\":\"Edgar National Centre for Diabetes Research, Dunedin, NZ\",\"last_name\":\"Jim I Mann, FRACP, PhD\"}],\"rank\":184684,\"condition_browse\":{\"mesh_term\":\"Insulin Resistance\"},\"keyword\":[\"Maori\",\"insulin sensitivity\",\"cardiovascular risk\",\"diabetes prevention\",\"diet modification\"],\"start_date\":\"August 2002\",\"has_expanded_access\":\"No\",\"phase\":\"N/A\",\"primary_outcome\":{\"measure\":\"Dietary intake as measured by 3-day weight diet records\"},\"secondary_outcome\":[{\"measure\":\"Blood pressure\"},{\"measure\":\"Bioelectric Impedence\"},{\"measure\":\"Weight\"},{\"measure\":\"Waist circumference\"},{\"measure\":\"Total cholesterol and lipid subfractions (LDL, HDL)\"},{\"measure\":\"Fasting insulin\"},{\"measure\":\"Lipoprotein A + B\"},{\"measure\":\"Inflammatory markers\"},{\"measure\":\"Urinary albumin:creatinine ratio\"},{\"measure\":\"Quality of life\"},{\"measure\":\"All measures to be compared at end of study (6 months)\"}],\"oversight_info\":{\"authority\":\"New Zealand: Health and Disability Ethics Committees\"},\"id_info\":{\"nct_id\":\"NCT00208637\",\"org_study_id\":\"Kai Study\"},\"lastchanged_date\":\"September 13, 2005\",\"enrollment\":{\"type\":\"NA\",\"content\":90},\"detailed_description\":{\"textblock\":\"This was a 6-month pilot intervention study of self-identifying Maori participants in a\r\n      randomised control trial conducted in Dunedin and Invercargill. The study consisted of\r\n      three, two month phases and was conducted over a period of six months. Participants meeting\r\n      all the inclusion criteria were randomised into three groups: moderate carbohydrate-high\r\n      protein (MCHP), high carbohydrate-high fibre (HCHF) or a control group. Those randomised to\r\n      the experimental diets were recommended an energy intake based on their current BMI levels.\r\n      The aim of phase one was to achieve weight loss with weekly advice and support from the\r\n      research team. The aim of phase two was for weight maintenance with continued weekly advice\r\n      and support. Phase three consisted of a weight maintenance phase without support. Those in\r\n      the control group were instructed to follow their own self selected diet plan.\r\n\r\n      Outcome was determined by examining surrogate clinical endpoints. The clinical endpoints\r\n      included the following recorded measurements of anthropometric measurements, bioelectrical\r\n      impedance measurements, profile of mood state questionnaires, activity questionnaires, and\r\n      three day diet records were collected at 0, 2, 4 and 6 month periods. Biochemical measures\r\n      of lipid profile, fasting insulin and glucose, liver functions and uric acid levels were\r\n      also conducted.\"},\"condition\":\"Insulin Resistance\",\"study_type\":\"Interventional\",\"required_header\":{\"download_date\":\"ClinicalTrials.gov processed this data on December 16, 2015\",\"link_text\":\"Link to the current ClinicalTrials.gov record.\",\"url\":\"https://clinicaltrials.gov/show/NCT00208637\"},\"study_design\":\"Allocation: Randomized, Endpoint Classification: Efficacy Study, Intervention Model: Parallel Assignment, Masking: Open Label, Primary Purpose: Treatment\",\"firstreceived_date\":\"September 13, 2005\",\"completion_date\":{\"type\":\"NA\",\"content\":\"December 2004\",\"location\":{\"facility\":{\"address\":{\"zip\":9001,\"country\":\"New Zealand\",\"city\":\"Dunedin\",\"state\":\"Otago\"},\"name\":\"Edgar National Centre for Diabetes Research\"}},\"intervention\":[{\"intervention_type\":\"Behavioral\",\"intervention_name\":\"moderate carbohydrate, high protein diet (MCHP)\"},{\"intervention_type\":\"Behavioral\"},\"intervention_name\":\"high carbohydrate-high fibre (HCHF) diet\"}],\"verification_date\":\"September 2005\"}}";
        String correctedJSON = "{\"clinical_study\":{\"brief_summary\":{\"textblock\":\"High protein diets are popular among Maori, especially on the East Coast of the North\r\n      Island. The purpose of this study was to compare the metabolic effects of a moderate\r\n      carbohydrate, high protein diet (MCHP) with a high carbohydrate-high fibre (HCHF) diet on\r\n      insulin sensitivity in Maori at increased risk of developing diabetes and cardiovascular\r\n      disease.\"},\"brief_title\":\"He Purongo Mo Nga Kai Hei Arai i Te Matehuka \u2013 Dietary Diabetes Prevention Study for Maori\",\"overall_status\":\"Completed\",\"link\":{\"description\":\"Edgar National Centre for Diabetes Research, NZ website\",\"url\":\"http://www.otago.ac.nz/diabetes\"},\"eligibility\":{\"minimum_age\":\"17.0\",\"gender\":\"Both\",\"criteria\":{\"textblock\":\"Inclusion Criteria:\r\n\r\n          -  Self identify as Maori aged between 17-75 years\r\n\r\n          -  Male and female\r\n\r\n          -  Non-diabetic\r\n\r\n          -  Resident of Dunedin and Invercargill\r\n\r\n          -  BMI >27\r\n\r\n          -  Family history of T2D\r\n\r\n        Exclusion Criteria:\r\n\r\n          -  The presence of diabetes, renal or liver failure, or any other medical condition\r\n             which is unstable and for which potential partcipants are currently having active\r\n             treatment.\"},\"healthy_volunteers\":\"Accepts Healthy Volunteers\",\"maximum_age\":\"75.0\"},\"source\":\"Edgar National Centre for Diabetes Research\",\"location_countries\":{\"country\":\"New Zealand\"},\"sponsors\":{\"lead_sponsor\":{\"agency_class\":\"Other\",\"agency\":\"Edgar National Centre for Diabetes Research\"}},\"overall_official\":[{\"role\":\"Principal Investigator\",\"affiliation\":\"Edgar National Centre for Diabetes Research, Dunedin, NZ\",\"last_name\":\"Lorraine Brooking, BSc, MA\"},{\"role\":\"Study Director\",\"affiliation\":\"Edgar National Centre for Diabetes Research, Dunedin, NZ\",\"last_name\":\"Jim I Mann, FRACP, PhD\"}],\"rank\":184684,\"condition_browse\":{\"mesh_term\":\"Insulin Resistance\"},\"keyword\":[\"Maori\",\"insulin sensitivity\",\"cardiovascular risk\",\"diabetes prevention\",\"diet modification\"],\"start_date\":\"August 2002\",\"has_expanded_access\":\"No\",\"phase\":\"N/A\",\"primary_outcome\":{\"measure\":\"Dietary intake as measured by 3-day weight diet records\"},\"secondary_outcome\":[{\"measure\":\"Blood pressure\"},{\"measure\":\"Bioelectric Impedence\"},{\"measure\":\"Weight\"},{\"measure\":\"Waist circumference\"},{\"measure\":\"Total cholesterol and lipid subfractions (LDL, HDL)\"},{\"measure\":\"Fasting insulin\"},{\"measure\":\"Lipoprotein A + B\"},{\"measure\":\"Inflammatory markers\"},{\"measure\":\"Urinary albumin:creatinine ratio\"},{\"measure\":\"Quality of life\"},{\"measure\":\"All measures to be compared at end of study (6 months)\"}],\"oversight_info\":{\"authority\":\"New Zealand: Health and Disability Ethics Committees\"},\"id_info\":{\"nct_id\":\"NCT00208637\",\"org_study_id\":\"Kai Study\"},\"lastchanged_date\":\"September 13, 2005\",\"enrollment\":{\"type\":\"NA\",\"content\":90},\"detailed_description\":{\"textblock\":\"This was a 6-month pilot intervention study of self-identifying Maori participants in a\r\n      randomised control trial conducted in Dunedin and Invercargill. The study consisted of\r\n      three, two month phases and was conducted over a period of six months. Participants meeting\r\n      all the inclusion criteria were randomised into three groups: moderate carbohydrate-high\r\n      protein (MCHP), high carbohydrate-high fibre (HCHF) or a control group. Those randomised to\r\n      the experimental diets were recommended an energy intake based on their current BMI levels.\r\n      The aim of phase one was to achieve weight loss with weekly advice and support from the\r\n      research team. The aim of phase two was for weight maintenance with continued weekly advice\r\n      and support. Phase three consisted of a weight maintenance phase without support. Those in\r\n      the control group were instructed to follow their own self selected diet plan.\r\n\r\n      Outcome was determined by examining surrogate clinical endpoints. The clinical endpoints\r\n      included the following recorded measurements of anthropometric measurements, bioelectrical\r\n      impedance measurements, profile of mood state questionnaires, activity questionnaires, and\r\n      three day diet records were collected at 0, 2, 4 and 6 month periods. Biochemical measures\r\n      of lipid profile, fasting insulin and glucose, liver functions and uric acid levels were\r\n      also conducted.\"},\"condition\":\"Insulin Resistance\",\"study_type\":\"Interventional\",\"required_header\":{\"download_date\":\"ClinicalTrials.gov processed this data on December 16, 2015\",\"link_text\":\"Link to the current ClinicalTrials.gov record.\",\"url\":\"https://clinicaltrials.gov/show/NCT00208637\"},\"study_design\":\"Allocation: Randomized, Endpoint Classification: Efficacy Study, Intervention Model: Parallel Assignment, Masking: Open Label, Primary Purpose: Treatment\",\"firstreceived_date\":\"September 13, 2005\",\"verification_date\":\"September 2005\"}}";

        String result = Indexer.stripCompletionDate(longJSON);
        
        assertEquals(correctedJSON, result);
    }
    
    public static void main(String[] args) {
        new StripCompletionDateTest().test_stripCompletionDate();
    }
	
}
